type Token @entity(immutable: false) {
  id: ID! # token address
  totalSupply: BigInt!
  bunniKeyHash: Bytes! # bytes32
  pool: Bytes! # address of Uniswap V3 pool
  tickLower: Int! # int24
  tickUpper: Int! # int24
  transfers: [Transfer!]! @derivedFrom(field: "token")
}

type TotalSupplySnapshot @entity(immutable: true) {
  id: ID!
  token: Token!
  totalSupply: BigInt!
  timestamp: BigInt!
  blockNumber: BigInt!
}

type PositionSnapshot @entity(immutable: true) {
  id: ID!
  token: Token!
  transfer: Transfer!
  totalSupply: BigInt!
  timestamp: BigInt!
  blockNumber: BigInt!

  # pool data
  tick: BigInt
  liquidity: BigInt
  token0: Bytes
  token1: Bytes
}

type Transfer @entity(immutable: true) {
  id: ID! # Transaction hash + log index
  token: Token!
  from: Bytes! # Address
  to: Bytes! # Address
  value: BigInt!
  blockNumber: BigInt!
  timestamp: BigInt!
}
